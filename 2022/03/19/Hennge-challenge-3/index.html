<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.2">

  <link rel="apple-touch-icon" sizes="180x180" href="/en/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/en/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/en/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/en/images/logo.svg" color="#222">
  <meta name="google-site-verification" content="1T-h_WTI8xskfXv9HxKWHfxqfzny6jcGdT5hmIExYqY">

<link rel="stylesheet" href="/en/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"youngforest.github.io","root":"/en/","images":"/en/images","scheme":"Mist","darkmode":false,"version":"8.15.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/en/js/config.js"></script>

    <meta name="description" content="Last Sunday, I submitted my application for the Hennge Back-end(Tokyo, Japan) SDE position. After that, my mail box received a Challenge 3 email from Hennge. The challenge is very interesting. When I">
<meta property="og:type" content="article">
<meta property="og:title" content="Hennge challenge 3">
<meta property="og:url" content="https://youngforest.github.io/en/2022/03/19/Hennge-challenge-3/index.html">
<meta property="og:site_name" content="YoungForest&#39;s blog">
<meta property="og:description" content="Last Sunday, I submitted my application for the Hennge Back-end(Tokyo, Japan) SDE position. After that, my mail box received a Challenge 3 email from Hennge. The challenge is very interesting. When I">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2022-03-19T05:17:20.000Z">
<meta property="article:modified_time" content="2023-04-12T11:09:15.258Z">
<meta property="article:author" content="杨森">
<meta property="article:tag" content="Hennge">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://youngforest.github.io/en/2022/03/19/Hennge-challenge-3/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://youngforest.github.io/en/2022/03/19/Hennge-challenge-3/","path":"2022/03/19/Hennge-challenge-3/","title":"Hennge challenge 3"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Hennge challenge 3 | YoungForest's blog</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-88350169-1"></script>
  <script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"UA-88350169-1","only_pageview":false}</script>
  <script src="/en/js/third-party/analytics/google-analytics.js"></script>







<script data-ad-client="ca-pub-9046219176772396" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9046219176772396"></script>

  <noscript>
    <link rel="stylesheet" href="/en/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/en/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">YoungForest's blog</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/en/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/en/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-tags"><a href="/en/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-categories"><a href="/en/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href="/en/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li><li class="menu-item menu-item-中文"><a href="https://youngforest.github.io/" rel="section"><i class="fa fa-language fa-fw"></i>中文</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Challenge-details"><span class="nav-number">1.</span> <span class="nav-text">Challenge details</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Follow-up"><span class="nav-number">2.</span> <span class="nav-text">Follow up</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">杨森</p>
  <div class="site-description" itemprop="description">A programmer in Amazon Beijing, China</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/en/archives/">
          <span class="site-state-item-count">10</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/en/categories/">
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/en/tags/">
        <span class="site-state-item-count">10</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/YoungForest" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;YoungForest" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:sen.yang96@outlook.com" title="E-Mail → mailto:sen.yang96@outlook.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/u/1111372490" title="Weibo → https:&#x2F;&#x2F;weibo.com&#x2F;u&#x2F;1111372490" rel="noopener me" target="_blank"><i class="fab fa-weibo fa-fw"></i>Weibo</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/youngforest" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;youngforest" rel="noopener me" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://stackoverflow.com/users/6393787/youngforest" title="StackOverflow → https:&#x2F;&#x2F;stackoverflow.com&#x2F;users&#x2F;6393787&#x2F;youngforest" rel="noopener me" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>StackOverflow</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.linkedin.com/in/sen-yang-a20a02137/" title="LinkedIn → https:&#x2F;&#x2F;www.linkedin.com&#x2F;in&#x2F;sen-yang-a20a02137&#x2F;" rel="noopener me" target="_blank"><i class="fab fa-linkedin fa-fw"></i>LinkedIn</a>
      </span>
      <span class="links-of-author-item">
        <a href="/en/atom.xml" title="RSS → &#x2F;atom.xml" rel="noopener me"><i class="fa fa-rss fa-fw"></i>RSS</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
    <div class="sidebar-inner sidebar-blogroll">
      <div class="links-of-blogroll animated">
        <div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i>
          Links
        </div>
        <ul class="links-of-blogroll-list">
            <li class="links-of-blogroll-item">
              <a href="https://www.kenshinji.me/" title="https:&#x2F;&#x2F;www.kenshinji.me" rel="noopener" target="_blank">Fred</a>
            </li>
            <li class="links-of-blogroll-item">
              <a href="https://jacklandrin.github.io/" title="https:&#x2F;&#x2F;jacklandrin.github.io" rel="noopener" target="_blank">LiuBo</a>
            </li>
            <li class="links-of-blogroll-item">
              <a href="https://xiaozhou.net/" title="https:&#x2F;&#x2F;xiaozhou.net" rel="noopener" target="_blank">Timothy</a>
            </li>
        </ul>
      </div>
    </div>
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://youngforest.github.io/en/2022/03/19/Hennge-challenge-3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/en/images/avatar.gif">
      <meta itemprop="name" content="杨森">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="YoungForest's blog">
      <meta itemprop="description" content="A programmer in Amazon Beijing, China">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Hennge challenge 3 | YoungForest's blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Hennge challenge 3
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-03-19 13:17:20" itemprop="dateCreated datePublished" datetime="2022-03-19T13:17:20+08:00">2022-03-19</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-04-12 19:09:15" itemprop="dateModified" datetime="2023-04-12T19:09:15+08:00">2023-04-12</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/en/categories/interview/" itemprop="url" rel="index"><span itemprop="name">interview</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/en/2022/03/19/Hennge-challenge-3/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2022/03/19/Hennge-challenge-3/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>Last Sunday, I submitted my application for the Hennge Back-end(Tokyo, Japan) SDE position. After that, my mail box received a Challenge 3 email from Hennge. The challenge is very interesting. When I had enough free time on this Saturday, I finished this challenge finally. I spent about 3 hours on this. The process is here.</p>
<h2 id="Challenge-details"><a href="#Challenge-details" class="headerlink" title="Challenge details"></a>Challenge details</h2><p>The Challenge link is 403 after I submitted my solution. So, I share the process from my memory.<br>Fortunately, the archive is here: <a target="_blank" rel="noopener" href="https://drive.google.com/file/d/1wWorFu889-DdEwuh9IAK2Eaei9rH1mGI/view?usp=sharing">Google Drive</a>.</p>
<p>First, implement a sum of squares of numbers program with Python/Go. You need to implement the input and output process by yourself.<br>Second, create a private github gist with the code.<br>Last, post the gist link to the Hennge server.</p>
<p>The code is very simple. I used Python to implement it.<br>Don’t ignore the instructions in the challenge.<br><strong>Specific rules for Python solution: Do not use any for loop, while loop, or any list / set / dictionary comprehension.</strong></p>
<p><a target="_blank" rel="noopener" href="https://pyneng.readthedocs.io/en/latest/book/08_python_basic_examples/x_comprehensions.html">What is list/set/dictionary comprehension?</a><br>It is <code>[x for x in a_list]</code> in Python.</p>
<p>We can use <code>map</code> and <code>reduce</code> in Python to replace the iteration. It is functional programming.<br>If you are familiar with some functional programming languages, like Lisp, you could know that there is no loop syntax existing and the recursive function is the same as the iteration.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">```python</span><br><span class="line"></span><br><span class="line">```python</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_non_negative_square_sum_from_input</span>():</span><br><span class="line">    X = <span class="built_in">int</span>(<span class="built_in">input</span>())</span><br><span class="line">    <span class="keyword">return</span> reduce(<span class="keyword">lambda</span> x, y: x + (y * y <span class="keyword">if</span> y &gt; <span class="number">0</span> <span class="keyword">else</span> <span class="number">0</span>), <span class="built_in">map</span>(<span class="built_in">int</span>, <span class="built_in">input</span>().split()), <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    N = <span class="built_in">int</span>(<span class="built_in">input</span>())</span><br><span class="line">    ans = reduce(<span class="keyword">lambda</span> x, y: <span class="built_in">print</span>(get_non_negative_square_sum_from_input()), <span class="built_in">range</span>(N), [])</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p>After struggle with Github two-factor authentication and manual account recovery review, I finally sign in to Github and created <a target="_blank" rel="noopener" href="https://gist.github.com/YoungForest/329c22200e7fad36e6ef984e3afe0325">my gist</a>, which is secret as required.</p>
<p>I think the hardest part is the authentication POST.</p>
<p>First, I needed to covert the shared secret to TOTP (Time-Based One-Time Password) with RFC 6238.<br>I tried to find a online tool to do that. But unfortunately, the current online tools have a limited options. For example, you can not choose the hash function as <code>HMAC-SHA-512</code> instead of default <code>HMAC-SHA-1</code>.<br>Therefore, as a result, I wrote a <a target="_blank" rel="noopener" href="https://totp.youngforest.me/">TOTP Generator Online</a> by myself. Hope it could help you.<br>Fortunately, I found a sample Java implementation in <a target="_blank" rel="noopener" href="https://datatracker.ietf.org/doc/html/rfc6238">the RFC 6238 document</a>. By the way, because the input in the code is a HEX string. I covert my shared secret <code>sen.yang96@outlook.comHENNGECHALLENGE003</code> to HEX string with <a target="_blank" rel="noopener" href="https://www.convertstring.com/EncodeDecode/HexEncode">a online tool</a>. The challenge required a 10-digits code. The default in the code is 8-digits. I met this response using 8-digits.</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">     <span class="attr">&quot;message&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Access denied: Invalid token, malformed token&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>After I changed it to 10-digits, the error updated to:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">     <span class="attr">&quot;message&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Access denied: Invalid token, wrong code&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>I debugged a lot and found that it is the issue of timestamp. Because TOTP is time-based.<br>When I change the timestamp to <code>Instant.now() + 30s</code>, the password passed:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;message&quot;</span><span class="punctuation">:</span><span class="string">&quot;Congratulations! You have achieved mission 3&quot;</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>The final code after my changes is:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">Copyright (c) 2011 IETF Trust and the persons identified as</span></span><br><span class="line"><span class="comment">authors of the code. All rights reserved.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Redistribution and use in source and binary forms, with or without</span></span><br><span class="line"><span class="comment">modification, is permitted pursuant to, and subject to the license</span></span><br><span class="line"><span class="comment">terms contained in, the Simplified BSD License set forth in Section</span></span><br><span class="line"><span class="comment">4.c of the IETF Trust&#x27;s Legal Provisions Relating to IETF Documents</span></span><br><span class="line"><span class="comment">(http://trustee.ietf.org/license-info).</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.UndeclaredThrowableException;</span><br><span class="line"><span class="keyword">import</span> java.security.GeneralSecurityException;</span><br><span class="line"><span class="keyword">import</span> java.text.DateFormat;</span><br><span class="line"><span class="keyword">import</span> java.text.SimpleDateFormat;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.Mac;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.spec.SecretKeySpec;</span><br><span class="line"><span class="keyword">import</span> java.math.BigInteger;</span><br><span class="line"><span class="keyword">import</span> java.util.TimeZone;</span><br><span class="line"><span class="keyword">import</span> java.time.Instant;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * This is an example implementation of the OATH</span></span><br><span class="line"><span class="comment"> * TOTP algorithm.</span></span><br><span class="line"><span class="comment"> * Visit www.openauthentication.org for more information.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Johan Rydell, PortWise, Inc.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TOTP</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">TOTP</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * This method uses the JCE to provide the crypto algorithm.</span></span><br><span class="line"><span class="comment">     * HMAC computes a Hashed Message Authentication Code with the</span></span><br><span class="line"><span class="comment">     * crypto hash algorithm as a parameter.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> crypto:   the crypto algorithm (HmacSHA1, HmacSHA256,</span></span><br><span class="line"><span class="comment">     *                  HmacSHA512)</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> keyBytes: the bytes to use for the HMAC key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> text:     the message or text to be authenticated</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">byte</span>[] hmac_sha(String crypto, <span class="type">byte</span>[] keyBytes,</span><br><span class="line">            <span class="type">byte</span>[] text) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Mac hmac;</span><br><span class="line">            hmac = Mac.getInstance(crypto);</span><br><span class="line">            <span class="type">SecretKeySpec</span> <span class="variable">macKey</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SecretKeySpec</span>(keyBytes, <span class="string">&quot;RAW&quot;</span>);</span><br><span class="line">            hmac.init(macKey);</span><br><span class="line">            <span class="keyword">return</span> hmac.doFinal(text);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (GeneralSecurityException gse) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">UndeclaredThrowableException</span>(gse);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * This method converts a HEX string to Byte[]</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> hex: the HEX string</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span>: a byte array</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">byte</span>[] hexStr2Bytes(String hex) &#123;</span><br><span class="line">        <span class="comment">// Adding one byte to get the right conversion</span></span><br><span class="line">        <span class="comment">// Values starting with &quot;0&quot; can be converted</span></span><br><span class="line">        <span class="type">byte</span>[] bArray = <span class="keyword">new</span> <span class="title class_">BigInteger</span>(<span class="string">&quot;10&quot;</span> + hex, <span class="number">16</span>).toByteArray();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Copy all the REAL bytes, not the &quot;first&quot;</span></span><br><span class="line">        <span class="type">byte</span>[] ret = <span class="keyword">new</span> <span class="title class_">byte</span>[bArray.length - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; ret.length; i++)</span><br><span class="line">            ret[i] = bArray[i + <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span>[] DIGITS_POWER</span><br><span class="line">    <span class="comment">// 0 1 2 3 4 5 6 7 8 9 10</span></span><br><span class="line">            = &#123; <span class="number">1</span>, <span class="number">10</span>, <span class="number">100</span>, <span class="number">1000</span>, <span class="number">10000</span>, <span class="number">100000</span>, <span class="number">1000000</span>, <span class="number">10000000</span>, <span class="number">100000000</span>, <span class="number">1000000000</span>, <span class="number">1000000000</span> &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * This method generates a TOTP value for the given</span></span><br><span class="line"><span class="comment">     * set of parameters.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key:          the shared secret, HEX encoded</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> time:         a value that reflects a time</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> returnDigits: number of digits to return</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span>: a numeric String in base 10 that includes</span></span><br><span class="line"><span class="comment">     *          &#123;<span class="doctag">@link</span> truncationDigits&#125; digits</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">generateTOTP</span><span class="params">(String key,</span></span><br><span class="line"><span class="params">            String time,</span></span><br><span class="line"><span class="params">            String returnDigits)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> generateTOTP(key, time, returnDigits, <span class="string">&quot;HmacSHA1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * This method generates a TOTP value for the given</span></span><br><span class="line"><span class="comment">     * set of parameters.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key:          the shared secret, HEX encoded</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> time:         a value that reflects a time</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> returnDigits: number of digits to return</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span>: a numeric String in base 10 that includes</span></span><br><span class="line"><span class="comment">     *          &#123;<span class="doctag">@link</span> truncationDigits&#125; digits</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">generateTOTP256</span><span class="params">(String key,</span></span><br><span class="line"><span class="params">            String time,</span></span><br><span class="line"><span class="params">            String returnDigits)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> generateTOTP(key, time, returnDigits, <span class="string">&quot;HmacSHA256&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * This method generates a TOTP value for the given</span></span><br><span class="line"><span class="comment">     * set of parameters.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key:          the shared secret, HEX encoded</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> time:         a value that reflects a time</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> returnDigits: number of digits to return</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span>: a numeric String in base 10 that includes</span></span><br><span class="line"><span class="comment">     *          &#123;<span class="doctag">@link</span> truncationDigits&#125; digits</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">generateTOTP512</span><span class="params">(String key,</span></span><br><span class="line"><span class="params">            String time,</span></span><br><span class="line"><span class="params">            String returnDigits)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> generateTOTP(key, time, returnDigits, <span class="string">&quot;HmacSHA512&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * This method generates a TOTP value for the given</span></span><br><span class="line"><span class="comment">     * set of parameters.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key:          the shared secret, HEX encoded</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> time:         a value that reflects a time</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> returnDigits: number of digits to return</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> crypto:       the crypto function to use</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span>: a numeric String in base 10 that includes</span></span><br><span class="line"><span class="comment">     *          &#123;<span class="doctag">@link</span> truncationDigits&#125; digits</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">generateTOTP</span><span class="params">(String key,</span></span><br><span class="line"><span class="params">            String time,</span></span><br><span class="line"><span class="params">            String returnDigits,</span></span><br><span class="line"><span class="params">            String crypto)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">codeDigits</span> <span class="operator">=</span> Integer.decode(returnDigits).intValue();</span><br><span class="line">        <span class="type">String</span> <span class="variable">result</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Using the counter</span></span><br><span class="line">        <span class="comment">// First 8 bytes are for the movingFactor</span></span><br><span class="line">        <span class="comment">// Compliant with base RFC 4226 (HOTP)</span></span><br><span class="line">        <span class="keyword">while</span> (time.length() &lt; <span class="number">16</span>)</span><br><span class="line">            time = <span class="string">&quot;0&quot;</span> + time;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Get the HEX in a Byte[]</span></span><br><span class="line">        <span class="type">byte</span>[] msg = hexStr2Bytes(time);</span><br><span class="line">        <span class="type">byte</span>[] k = hexStr2Bytes(key);</span><br><span class="line">        <span class="type">byte</span>[] hash = hmac_sha(crypto, k, msg);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// put selected bytes into result int</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">offset</span> <span class="operator">=</span> hash[hash.length - <span class="number">1</span>] &amp; <span class="number">0xf</span>;</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> <span class="variable">binary</span> <span class="operator">=</span> ((hash[offset] &amp; <span class="number">0x7f</span>) &lt;&lt; <span class="number">24</span>) |</span><br><span class="line">                ((hash[offset + <span class="number">1</span>] &amp; <span class="number">0xff</span>) &lt;&lt; <span class="number">16</span>) |</span><br><span class="line">                ((hash[offset + <span class="number">2</span>] &amp; <span class="number">0xff</span>) &lt;&lt; <span class="number">8</span>) |</span><br><span class="line">                (hash[offset + <span class="number">3</span>] &amp; <span class="number">0xff</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> <span class="variable">otp</span> <span class="operator">=</span> binary % DIGITS_POWER[codeDigits];</span><br><span class="line"></span><br><span class="line">        result = Integer.toString(otp);</span><br><span class="line">        <span class="keyword">while</span> (result.length() &lt; codeDigits) &#123;</span><br><span class="line">            result = <span class="string">&quot;0&quot;</span> + result;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">// Seed for HMAC-SHA1 - 20 bytes</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">seed</span> <span class="operator">=</span> <span class="string">&quot;3132333435363738393031323334353637383930&quot;</span>;</span><br><span class="line">        <span class="comment">// Seed for HMAC-SHA256 - 32 bytes</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">seed32</span> <span class="operator">=</span> <span class="string">&quot;3132333435363738393031323334353637383930&quot;</span> +</span><br><span class="line">                <span class="string">&quot;313233343536373839303132&quot;</span>;</span><br><span class="line">        <span class="comment">// Seed for HMAC-SHA512 - 64 bytes</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">seed64</span> <span class="operator">=</span> <span class="string">&quot;73656E2E79616E673936406F75746C6F6F6B2E636F6D48454E4E47454348414C4C454E4745303033&quot;</span>;</span><br><span class="line">        <span class="comment">// &quot;3132333435363738393031323334353637383930&quot; +</span></span><br><span class="line">        <span class="comment">//         &quot;3132333435363738393031323334353637383930&quot; +</span></span><br><span class="line">        <span class="comment">//         &quot;3132333435363738393031323334353637383930&quot; +</span></span><br><span class="line">        <span class="comment">//         &quot;31323334&quot;;</span></span><br><span class="line">        <span class="type">long</span> <span class="variable">T0</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">long</span> <span class="variable">X</span> <span class="operator">=</span> <span class="number">30</span>;</span><br><span class="line">        <span class="type">long</span> testTime[] = &#123; Instant.now().toEpochMilli() / <span class="number">1000L</span> + <span class="number">30</span> &#125;; <span class="comment">// &#123; 30L, 59L, 1111111109L, 1111111111L,</span></span><br><span class="line">                <span class="comment">// 1234567890L, 2000000000L, 20000000000L &#125;;</span></span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">steps</span> <span class="operator">=</span> <span class="string">&quot;0&quot;</span>;</span><br><span class="line">        <span class="type">DateFormat</span> <span class="variable">df</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SimpleDateFormat</span>(<span class="string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>);</span><br><span class="line">        df.setTimeZone(TimeZone.getTimeZone(<span class="string">&quot;UTC&quot;</span>));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            System.out.println(</span><br><span class="line">                    <span class="string">&quot;+---------------+-----------------------+&quot;</span> +</span><br><span class="line">                            <span class="string">&quot;------------------+--------+--------+&quot;</span>);</span><br><span class="line">            System.out.println(</span><br><span class="line">                    <span class="string">&quot;|  Time(sec)    |   Time (UTC format)   &quot;</span> +</span><br><span class="line">                            <span class="string">&quot;| Value of T(Hex)  |  TOTP  | Mode   |&quot;</span>);</span><br><span class="line">            System.out.println(</span><br><span class="line">                    <span class="string">&quot;+---------------+-----------------------+&quot;</span> +</span><br><span class="line">                            <span class="string">&quot;------------------+--------+--------+&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; testTime.length; i++) &#123;</span><br><span class="line">                <span class="type">long</span> <span class="variable">T</span> <span class="operator">=</span> (testTime[i] - T0) / X;</span><br><span class="line">                steps = Long.toHexString(T).toUpperCase();</span><br><span class="line">                <span class="keyword">while</span> (steps.length() &lt; <span class="number">16</span>)</span><br><span class="line">                    steps = <span class="string">&quot;0&quot;</span> + steps;</span><br><span class="line">                <span class="type">String</span> <span class="variable">fmtTime</span> <span class="operator">=</span> String.format(<span class="string">&quot;%1$-11s&quot;</span>, testTime[i]);</span><br><span class="line">                <span class="type">String</span> <span class="variable">utcTime</span> <span class="operator">=</span> df.format(<span class="keyword">new</span> <span class="title class_">Date</span>(testTime[i] * <span class="number">1000</span>));</span><br><span class="line">                System.out.print(<span class="string">&quot;|  &quot;</span> + fmtTime + <span class="string">&quot;  |  &quot;</span> + utcTime +</span><br><span class="line">                        <span class="string">&quot;  | &quot;</span> + steps + <span class="string">&quot; |&quot;</span>);</span><br><span class="line">                System.out.println(generateTOTP(seed, steps, <span class="string">&quot;8&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;HmacSHA1&quot;</span>) + <span class="string">&quot;| SHA1   |&quot;</span>);</span><br><span class="line">                System.out.print(<span class="string">&quot;|  &quot;</span> + fmtTime + <span class="string">&quot;  |  &quot;</span> + utcTime +</span><br><span class="line">                        <span class="string">&quot;  | &quot;</span> + steps + <span class="string">&quot; |&quot;</span>);</span><br><span class="line">                System.out.println(generateTOTP(seed32, steps, <span class="string">&quot;8&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;HmacSHA256&quot;</span>) + <span class="string">&quot;| SHA256 |&quot;</span>);</span><br><span class="line">                System.out.print(<span class="string">&quot;|  &quot;</span> + fmtTime + <span class="string">&quot;  |  &quot;</span> + utcTime +</span><br><span class="line">                        <span class="string">&quot;  | &quot;</span> + steps + <span class="string">&quot; |&quot;</span>);</span><br><span class="line">                System.out.println(generateTOTP(seed64, steps, <span class="string">&quot;10&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;HmacSHA512&quot;</span>) + <span class="string">&quot;| SHA512 |&quot;</span>);</span><br><span class="line"></span><br><span class="line">                System.out.println(</span><br><span class="line">                        <span class="string">&quot;+---------------+-----------------------+&quot;</span> +</span><br><span class="line">                                <span class="string">&quot;------------------+--------+--------+&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (<span class="keyword">final</span> Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Second, I should send my post with <a target="_blank" rel="noopener" href="https://datatracker.ietf.org/doc/html/rfc2617#section-2">HTTP Basic Authentication (RFC 2617)</a>.<br>The use-id is my email and password is the TOTP code. With the help of <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/20803339/basic-authorization-command-for-curl">this StackOverflow question: basic authorization command for curl</a>, there is 2 options to do this.</p>
<ol>
<li>Manually get Base64 encoded string and send it.</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">I tested on a Mac OS.</span></span><br><span class="line">echo -ne &quot;sen.yang96@outlook.com:&lt;TOTP 10 digits code&gt;&quot; | base64</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">output is something like this: c2VuLnlhbmc5NkBvdXRsb29rLmNvbTo4MzUzMDkyMA==</span></span><br><span class="line">curl -d &#x27;&#123;  &quot;github_url&quot;: &quot;https://gist.github.com/YoungForest/329c22200e7fad36e6ef984e3afe0325&quot;,  &quot;contact_email&quot;: &quot;sen.yang96@outlook.com&quot;,  &quot;solution_language&quot;: &quot;python&quot;&#125;&#x27; -H &#x27;Content-Type: application/json&#x27; -H &#x27;Authorization: Basic &lt;Base64 string&gt;&#x27; https://api.challenge.hennge.com/challenges/003</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>CURL could help you do the Base64 encoding.<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -d &#x27;&#123;  &quot;github_url&quot;: &quot;https://gist.github.com/YoungForest/329c22200e7fad36e6ef984e3afe0325&quot;,  &quot;contact_email&quot;: &quot;sen.yang96@outlook.com&quot;,  &quot;solution_language&quot;: &quot;python&quot;&#125;&#x27; -H &#x27;Content-Type: application/json&#x27; -u sen.yang96@outlook.com:&lt;TOTP 10 digits code&gt; https://api.challenge.hennge.com/challenges/003</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h2 id="Follow-up"><a href="#Follow-up" class="headerlink" title="Follow up"></a>Follow up</h2><p>After the congratulations response, I received a link by email to submit my Resume and CV.<br>It was my first time to do the challenge in a job application. I had done some homeworks/assignments and OA tests before. This challenge is so different and interesting. Through it, I learned a lot about TOTP and HTTP authentication.</p>
<p>Unfortunately, the final result is not good. I didn’t get any interview. I knew a few people who applied <strong>Hennge</strong> too because of this article. No one gets interviews and further progress after this challenge. If you complete the challenge and don’t get good response, it’s not your fault. Hennge seems just don’t hire candidates through the challenge.</p>
<blockquote>
<p>Thank you for your interest in Back-End Engineer position at HENNGE and for taking the time to complete the test.</p>
<p>While we were impressed with your background and experience, the selection process was highly competitive and unfortunately we have decided to move forward with another candidate that better fits our requirements at the moment.</p>
<p>Please understand that HENNGE does not provide specific details on the results of the application process.</p>
<p>We wish you the best of luck in your future endeavors.</p>
<p>Best regards,<br>HENNGE Recruiting Team</p>
</blockquote>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="followme">
  <span>Welcome to my other publishing channels</span>

  <div class="social-list">

      <div class="social-item">
          <span class="social-link">
            <span class="icon">
              <i class="fab fa-weixin"></i>
            </span>

            <span class="label">WeChat</span>
          </span>

          <img class="social-item-img" src="/en/uploads/wechat-qcode.jpg">
      </div>

      <div class="social-item">
          <a target="_blank" class="social-link" href="/en/atom.xml">
            <span class="icon">
              <i class="fa fa-rss"></i>
            </span>

            <span class="label">RSS</span>
          </a>
      </div>
  </div>
</div>

          <div class="post-tags">
              <a href="/en/tags/Hennge/" rel="tag"># Hennge</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/en/2021/12/18/Migrate-from-Travis-CI-to-Github-Action/" rel="prev" title="Migrate from Travis CI to Github Action">
                  <i class="fa fa-chevron-left"></i> Migrate from Travis CI to Github Action
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/en/2022/12/17/Windows-Dev-Improvement/" rel="next" title="Windows Development Environment improvement tips From a Microsoft Employee">
                  Windows Development Environment improvement tips From a Microsoft Employee <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    
  <div class="comments" id="disqus_thread">
    <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
  </div>
  
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">杨森</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/mist/" rel="noopener" target="_blank">NexT.Mist</a>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

  <a href="https://github.com/YoungForest" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/en/js/comments.js"></script><script src="/en/js/utils.js"></script><script src="/en/js/motion.js"></script><script src="/en/js/schemes/muse.js"></script><script src="/en/js/next-boot.js"></script>

  




  




<script class="next-config" data-name="disqus" type="application/json">{"enable":true,"shortname":"YoungForest","count":true,"i18n":{"disqus":"disqus"}}</script>
<script src="/en/js/third-party/comments/disqus.js"></script>

</body>
</html>
